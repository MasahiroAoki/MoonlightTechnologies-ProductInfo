# Cogitate ユーザーマニュアル

## 1. 概要

Cogitateは、複数のAIエージェントが協調して一つの回答を生成するための、会議風の対話型プラットフォームです。ユーザーは動的にエージェントチームを編成し、各エージェントに役割と使用する大規模言語モデル（LLM）を割り当てることができます。これにより、単一のAIでは得られない、多角的で洗練された回答を生成するプロセスを体験できます。

## 2. ユーザーロール

本システムには2つのユーザーロールがあります。

- **管理者 (Administrator)**: すべてのユーザーアカウントの管理（ロール変更、削除など）や、システム全体の設定を行う権限を持ちます。
- **オペレーター (Operator)**: このシステムの主要な利用者です。自身のアカウントでログインし、個人のLLM APIキーを設定して、AIエージェントによる会議を実行します。

## 3. 利用開始までの流れ

### 3.1 ユーザー登録
初めて利用する場合は、まずユーザーアカウントを作成する必要があります。
1.  ログイン画面の `Register` リンクをクリックします。
2.  ユーザー名、メールアドレス、パスワードを入力し、登録を完了します。
3.  登録が完了すると、自動的にログインページにリダイレクトされます。

### 3.2 ログイン
1.  ログインページで、登録したユーザー名とパスワードを入力します。
2.  `Login` ボタンをクリックします。

### 3.3 APIキーの設定（オペレーターのみ）
オペレーターとして初めてログインした場合、LLM APIキーの設定画面が表示されます。
1.  ご自身が利用するLLMプロバイダー（OpenAI, xAI, Googleなど）のAPIキーを入力します。
2.  `Save Key` ボタンをクリックしてキーを保存します。このキーは暗号化されて安全に保管されます。
3.  キーを保存すると、メインの会議設定画面にリダイレクトされます。

## 4. メイン画面 (会議設定ビュー)

ログインと初期設定が完了すると、会議設定ビュー（Meeting View）が表示されます。ここで、会議に参加するAIエージェントのチームを編成します。

- **エージェントカード (Agent Card)**: 画面に表示される各カードが一人のAIエージェントを表します。
  - **Agent Name**: エージェントの表示名です。自由に変更できます。
  - **Role**: エージェントの専門性や背景を示すための初期役割です（例: 「ソフトウェアエンジニア」）。この役割はAIの回答のトーンに影響を与えますが、後のステップで割り当てる機能的な役割とは異なります。
  - **LLM Provider**: エージェントが使用するLLMを選択します（`chatgpt`, `gemini`, `grok`, `claude`, `local`など）。
  - **Ollama Model Name** (ローカルLLM選択時のみ): `LLM Provider`で`local`を選択した場合に表示されます。使用したいOllamaのモデル名（例: `llama3`, `mistral`）を正確に入力します。
- **+ Add Agent ボタン**: クリックすると、新しいエージェントカードがグリッドに追加されます。
- **クエリ入力欄**: 画面下部のチャットインターフェースに、エージェントチームに議論してほしい議題や質問を入力します。
- **送信ボタン**: クエリを入力し、送信ボタン（紙飛行機のアイコン）をクリックすると、会議が開始され、ログビューに切り替わります。

## 5. 会議ログビュー (多段階ワークフロー)

会議が開始されると、画面が自動的に会議ログビューに切り替わります。このビューは、中央のメインパネルと右側のサイドバーで構成されています。

### 5.1 メインパネルでの操作

メインパネルには、エージェントの回答と、次のステップに進むための操作が表示されます。

1.  **ステージ1: ブレインストーミングと役割割り当て**
    - **初期回答の確認**: まず、すべてのエージェントが最初のクエリに対する回答を生成し、各エージェントカードに表示します。
    - **機能的な役割の割り当て**: 各カードのドロップダウンメニューを使い、意図したワークフローに合わせて各エージェントに専門的な役割を割り当てます。最適な結果を得るには、「Research」「Counter-argument」「Literature」の役割をそれぞれ1人ずつ割り当てることを推奨します。
    - **深掘りクエリの入力**: `Elaboration Query`というラベルの付いたテキストボックスに、ステージ2で議論を深めるための新しい指示や質問を入力します。
    - **ワークフローの続行**: `Submit Roles and Continue` ボタンをクリックすると、ステージ2に進みます。

2.  **ステージ2: 深掘りと最終化**
- **リアルタイム更新**: ステージ2では、各エージェントが割り当てられた役割と新しいクエリに基づいて、より専門的な議論を展開します。その様子がサイドバーの`Conference Log`に、タイプライターのように一文字ずつリアルタイムで表示されます。
    - すべてのプロセスが完了すると、最終的な回答が生成されます（今後の実装）。

- **Back to Setup ボタン**: いつでも会議を中断し、エージェントの構成をやり直したい場合は、このボタンで設定画面に戻ることができます。

### 5.2 サイドバーでの確認

右側のサイドバーでは、ワークフローの進行状況を詳細に確認できます。

- **Live Workflow**: 現在のワークフローの構造と、アクティブなノード（処理ステップ）を視覚的に表示します。
- **Conference Log**: 会議の全発言履歴を時系列で表示します。どのエージェントが、どのターンで、どのような役割（Role）で発言したかが一目でわかります。

## 6. 管理者機能

管理者ロールでログインしている場合、ナビゲーションバーの `Admin` リンクから管理者ダッシュボードにアクセスできます。

### 6.1 ユーザー管理
- **ユーザー一覧**: システムに登録されている全ユーザーのリストが表示されます。
- **ロール変更**: 各ユーザーの役割を `operator` と `administrator` の間で切り替えることができます。
- **ユーザー削除**: 不要なユーザーアカウントを削除できます。

### 6.2 Ollamaモデル管理
ダッシュボードから「Ollama Manager」にアクセスすると、ローカルで利用可能なOllamaモデルを管理できます。
- **利用可能なモデルの一覧**: サーバーにダウンロード済みのモデルがリスト表示されます。
- **新しいモデルのプル（ダウンロード）**: 新しいモデル名（例: `codellama:latest`）を入力して「Pull Model」ボタンを押すと、バックグラウンドでダウンロードが開始されます。大規模なモデルは時間がかかる場合があります。
- **リストの更新**: 「Refresh List」ボタンで、最新のモデル一覧に更新できます。
