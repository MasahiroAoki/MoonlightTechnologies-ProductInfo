# Cogitate ユーザーマニュアル

## 1. 概要

Cogitateは、複数のAIエージェントが協調して一つの回答を生成するための、会議風の対話型プラットフォームです。ユーザーは動的にエージェントチームを編成し、各エージェントに役割と使用する大規模言語モデル（LLM）を割り当てることができます。このシステムの中核は、人間のユーザーがAIのプロセスに介入し、指示を与える「人間参加型（Human-in-the-Loop）」のワークフローです。

## 2. ユーザーロール

本システムには2つのユーザーロールがあります。

- **管理者 (Administrator)**: すべてのユーザーアカウントの管理（ロール変更、削除など）や、システム全体の設定を行う権限を持ちます。
- **オペレーター (Operator)**: このシステムの主要な利用者です。自身のアカウントでログインし、個人のLLM APIキーを設定して、AIエージェントによる会議を実行します。

## 3. 利用開始までの流れ

### 3.1 ユーザー登録
初めて利用する場合は、まずユーザーアカウントを作成する必要があります。
1.  ログイン画面の `Register` リンクをクリックします。
2.  ユーザー名、メールアドレス、パスワードを入力し、登録を完了します。
3.  登録が完了すると、自動的にログインページにリダイレクトされます。

### 3.2 ログイン
1.  ログインページで、登録したユーザー名とパスワードを入力します。
2.  `Login` ボタンをクリックします。

### 3.3 APIキーの設定（オペレーターのみ）
オペレーターとして初めてログインした場合、LLM APIキーの設定画面が表示されます。
1.  ご自身が利用するLLMプロバイダー（OpenAI, xAI, Googleなど）のAPIキーを入力します。
2.  `Save Key` ボタンをクリックしてキーを保存します。このキーは暗号化されて安全に保管されます。
3.  キーを保存すると、メインの会議設定画面にリダイレクトされます。

## 4. メイン画面 (会議設定ビュー)

ログインと初期設定が完了すると、会議設定ビュー（Meeting View）が表示されます。ここで、会議に参加するAIエージェントのチームを編成します。

- **エージェントカード (Agent Card)**: 画面に表示される各カードが一人のAIエージェントを表します。
  - **Agent Name**: エージェントの表示名です。自由に変更できます。
  - **Initial Role (temp)**: エージェントの専門性や背景を示すための初期役割です（例: 「ソフトウェアエンジニア」）。この役割はAIの回答のトーンに影響を与えますが、後のステップで割り当てる機能的な役割とは異なります。
  - **LLM Provider**: エージェントが使用するLLMを選択します（`chatgpt`, `gemini`, `grok`, `claude`, `local`など）。
  - **Ollama Model Name** (ローカルLLM選択時のみ): `LLM Provider`で`local`を選択した場合に表示されます。使用したいOllamaのモデル名（例: `llama3`, `mistral`）を正確に入力します。
- **+ Add Agent ボタン**: クリックすると、新しいエージェントカードがグリッドに追加されます。
- **クエリ入力欄**: 画面下部のチャットインターフェースに、エージェントチームに議論してほしい議題や質問を入力します。
- **送信ボタン**: クエリを入力し、送信ボタン（紙飛行機のアイコン）をクリックすると、会議が開始され、ログビューに切り替わります。

## 5. 会議ログビュー (人間参加型ワークフロー)

会議が開始されると、画面が自動的に会議ログビューに切り替わります。このビューは、中央のメインパネルと右側のサイドバーで構成されています。ワークフローは以下のステージで進行します。

### 5.1 ステージ1: ブレインストーミングと役割割り当て
1.  **初期回答の確認**: まず、すべてのエージェントが最初のクエリに対する回答を生成し、各エージェントカードに表示されます。
2.  **機能的な役割の割り当て**: 各カードのドロップダウンメニューを使い、次のステップのために各エージェントに専門的な役割を割り当てます。
    *   **Drafter (起草者)**: 他のエージェントの回答を統合し、包括的な下書きを作成します。**この役割は必ず1人に割り当ててください。**
    *   **Verifier (検証者)**: Drafterが作成した下書きをレビューし、事実確認や誤りの指摘を行います。複数人に割り当て可能です。
    *   **Judge (評価者)**: Drafterが作成した下書きの品質を、明確さ、正確さ、網羅性に基づいて評価します。**この役割は必ず1人に割り当ててください。**
3.  **深掘りクエリの入力**: `Elaboration Query`というラベルの付いたテキストボックスに、Drafterへの追加の指示や、議論を深めるための新しい質問を入力します。
4.  **ワークフローの続行**: `Submit Roles and Continue` ボタンをクリックすると、ステージ2に進みます。

### 5.2 ステージ2: 実行と最終化
- **リアルタイム更新**: ステージ2では、各エージェントが割り当てられた役割とあなたの指示に基づいて、タスク（起草、評価、検証）を順番に実行します。その様子がサイドバーの`Conference Log`に、タイプライターのように一文字ずつリアルタイムで表示されます。
- すべてのプロセスが完了すると、最終的な回答がメインパネルに表示されます。

- **Back to Setup ボタン**: いつでも会議を中断し、エージェントの構成をやり直したい場合は、このボタンで設定画面に戻ることができます。

### 5.3 サイドバーでの確認

右側のサイドバーでは、ワークフローの進行状況を詳細に確認できます。

- **Live Workflow**: 現在のワークフローの構造と、アクティブなノード（処理ステップ）を視覚的に表示します。
- **Conference Log**: 会議の全発言履歴を時系列で表示します。どのエージェントが、どのターンで、どのような役割（Role）で発言したかが一目でわかります。

## 6. 多言語対応
本アプリケーションは、日本語と英語のUIをサポートしています。ナビゲーションバーの言語スイッチャーで言語を切り替えると、UIだけでなく、**AIエージェントの応答言語も自動的に選択した言語に切り替わります。**

## 7. 管理者機能

管理者ロールでログインしている場合、ナビゲーションバーの `Admin` リンクから管理者ダッシュボードにアクセスできます。

### 7.1 ユーザー管理
- **ユーザー一覧**: システムに登録されている全ユーザーのリストが表示されます。
- **ロール変更**: 各ユーザーの役割を `operator` と `administrator` の間で切り替えることができます。
- **ユーザー削除**: 不要なユーザーアカウントを削除できます。

### 7.2 Ollamaモデル管理
ダッシュボードから「Ollama Manager」にアクセスすると、ローカルで利用可能なOllamaモデルを管理できます。
- **利用可能なモデルの一覧**: サーバーにダウンロード済みのモデルがリスト表示されます。
- **新しいモデルのプル（ダウンロード）**: 新しいモデル名（例: `codellama:latest`）を入力して「Pull Model」ボタンを押すと、バックグラウンドでダウンロードが開始されます。大規模なモデルは時間がかかる場合があります。
- **リストの更新**: 「Refresh List」ボタンで、最新のモデル一覧に更新できます。